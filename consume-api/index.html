<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue Todos | Consume an API with Vue</title>
    <meta name="description" content="A Vue.js tutorial series that builds from the most basic task list example to a full PWA connected to a backend REST API built with Laravel.">
    
    
    <link rel="preload" href="/vue-todos/assets/css/2.styles.fee045ff.css" as="style"><link rel="preload" href="/vue-todos/assets/js/app.909434ad.js" as="script"><link rel="preload" href="/vue-todos/assets/js/0.a2d473ea.js" as="script"><link rel="prefetch" href="/vue-todos/assets/js/1.b535ad73.js">
    <link rel="stylesheet" href="/vue-todos/assets/css/2.styles.fee045ff.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/vue-todos/" class="home-link router-link-active"><!----><span class="site-name">
      Vue Todos
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><a href="/vue-todos/consume-api/" class="active sidebar-link">Consume an API with Vue</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#base-url" class="sidebar-link">Base URL</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#api-resource-routes" class="sidebar-link">API Resource Routes</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#using-the-axios-library" class="sidebar-link">Using the Axios library</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#install-axios" class="sidebar-link">Install Axios</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#response-objects" class="sidebar-link">Response Objects</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#handling-promises" class="sidebar-link">Handling promises</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#catching-errors" class="sidebar-link">Catching errors</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#working-examples" class="sidebar-link">Working Examples</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#load-a-collection-of-resource-objects" class="sidebar-link">Load a collection of resource objects</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#load-a-single-resource-object" class="sidebar-link">Load a single resource object</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#save-a-new-resource-object" class="sidebar-link">Save a new resource object</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#update-a-resource-object" class="sidebar-link">Update a resource object</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#delete-a-resource-object" class="sidebar-link">Delete a resource object</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#authentication-headers" class="sidebar-link">Authentication Headers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#login-get-a-token" class="sidebar-link">Login / Get a Token</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#show-hide-the-login-page" class="sidebar-link">Show / Hide the Login Page</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#save-the-token" class="sidebar-link">Save the token</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#computed-properties" class="sidebar-link">Computed Properties</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#axios-options-object" class="sidebar-link">Axios Options Object</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#load-saved-token-on-startup" class="sidebar-link">Load saved token on startup</a></li><li class="sidebar-sub-header"><a href="/vue-todos/consume-api/#oh-one-more-thing" class="sidebar-link">Oh, one more thing ...</a></li></ul></li></ul></li></ul></div><div class="page"><div class="content"><h1 id="consume-an-api-with-vue"><a href="#consume-an-api-with-vue" aria-hidden="true" class="header-anchor">#</a> Consume an API with Vue</h1><h2 id="overview"><a href="#overview" aria-hidden="true" class="header-anchor">#</a> Overview</h2><p>So far in this series, we have built a good working prototype for our Vue Todos app. However, so far the prototype only persists data to localStorage -- which means we cannot see our todo list on more than one device. Now it is time to &quot;make it real&quot;.</p><p>Using the Axios library, we will wire up our Vue application to persist data to a backend server using AJAX calls and a <a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="noopener noreferrer">RESTful API</a>. This API server will be our &quot;single source of truth&quot; for the application's data, and we will be able to login from any web browser.</p><p>The backend API server will be based on the examples that we have been building earlier in this tutorial series. If you have completed the <em>Build an API with Laravel</em> tutorial section, you can use that to test against. However, you are NOT required to deploy your own <a href="https://laravel.com" target="_blank" rel="noopener noreferrer">Laravel</a> application instance to complete this tutorial.</p><h2 id="base-url"><a href="#base-url" aria-hidden="true" class="header-anchor">#</a> Base URL</h2><p>If you have a working Laravel API based on the <em>Build an API with Laravel</em> tutorial, it is probably available in your local development environment at <a href="https://laravel-todos.test/api" target="_blank" rel="noopener noreferrer">https://laravel-todos.test/api</a>.</p><p>If you haven't built your own backend API yet, you can use this demo version for testing your Vue Todos app. The base URL for the demo API will be <a href="https://vue-todos.robertmckenney.ca/api" target="_blank" rel="noopener noreferrer">https://vue-todos.robertmckenney.ca/api</a>.</p><h2 id="api-resource-routes"><a href="#api-resource-routes" aria-hidden="true" class="header-anchor">#</a> API Resource Routes</h2><p>This chart outlines the REST Resource Routes that will be available and their corresponding Laravel controller actions.</p><table><tbody><tr><td><strong>HTTP Method</strong></td><td><strong>Resource URI</strong></td><td><strong>Controller Action</strong></td><td><strong>Description</strong></td></tr><tr><td>GET</td><td>/categories</td><td>CategoryController@index</td><td>Returns an array of Category objects.</td></tr><tr><td>GET</td><td>/categories/{id}</td><td>CategoryController@show</td><td>Returns a single Category object <span>with an id property matching the <code>{id}</code> route parameter</span>.</td></tr><tr><td>POST</td><td>/categories</td><td>CategoryController@store</td><td><p>Creates a new Category object. Expects a JSON encoded object with at least a name property and an optional description property. e.g.</p><pre><code>{ 
  name: 'hobbies', 
  description: ''
}</code></pre><p><span>Saves the new Category in the database and returns the same Category object with a unique id.</span></p></td></tr><tr><td>PUT</td><td>/categories/{id}</td><td>CategoryController@update</td><td><p><span>Expects a JSON encoded Category object in the body. Updates the new </span>Category in the database with the values included in the received JSON object and returns the updated <span>Category</span> object.</p></td></tr><tr><td>DELETE</td><td>/categories/{id}</td><td>CategoryController@destroy</td><td><p>Deletes a single <span>Category</span> object from the database where the id property matches the <code>{id}</code> route parameter.</p></td></tr><tr><td>GET</td><td>/priorities</td><td>PriorityController@index</td><td><p>Returns an array of Priority objects.</p></td></tr><tr><td>GET</td><td>/priorities/{id}</td><td>PriorityController@show</td><td><p>Returns a single Priority object <span>with an id property matching the <code>{id}</code> route parameter</span>.</p></td></tr><tr><td>GET</td><td>/todos</td><td>TodoController@index</td><td><p>Returns an array of Todo objects.</p></td></tr><tr><td>GET</td><td>/todos/{id}</td><td>TodoController@show</td><td><p>Returns a single Todo object with an id property matching the <code>{id}</code> route parameter.</p></td></tr><tr><td>POST</td><td>/todos</td><td>TodoController@store</td><td><p>Expects a JSON encoded Todo object in the body. Saves the new Todo in the database and returns the same Todo object with a valid id property set.</p></td></tr><tr><td>PUT</td><td>/todos/{id}</td><td>TodoController@update</td><td><p><span>Expects a JSON encoded Todo object in the body. Updates the new Todo in the database with the values included in the received JSON object and returns the updated Todo object.</span></p></td></tr><tr><td>DELETE</td><td>/todos/{id}</td><td>TodoController@destroy</td><td><p>Deletes a single Todo object from the database where the id property matches the <code>{id}</code> route parameter.</p></td></tr></tbody></table><h2 id="using-the-axios-library"><a href="#using-the-axios-library" aria-hidden="true" class="header-anchor">#</a> Using the Axios library</h2><div class="tip custom-block"><p class="custom-block-title">Promise based HTTP client for the browser and node.js</p><p>See the <a href="https://github.com/axios/axios" target="_blank" rel="noopener noreferrer">Axios documentation</a> in the official GitHub repository.</p></div><p>To consume the backend API resources from our Vue application, we need to make <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/AJAX" target="_blank" rel="noopener noreferrer">AJAX</a> based communications requests to the server. The traditional way to do this from the browser is to use <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest" target="_blank" rel="noopener noreferrer">XMLHttpRequest (XHR) objects</a>, however, the API for this is quite cumbersome. The newer HTML 5 web API has a much improved replacement called <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" target="_blank" rel="noopener noreferrer">fetch</a>, but it still has some annoying limitations.</p><p>Axios is a very popular open source library that has powerful features, but is very simple to use for 90% of use cases. So, we will use Axios for the rest of these examples.</p><h3 id="install-axios"><a href="#install-axios" aria-hidden="true" class="header-anchor">#</a> Install Axios</h3><p>Don't forget to add the Axios library to your project. Using the terminal, in the project folder enter the following command to add axios as a dependancy for your project.</p><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> axios
</code></pre><p>Next, import the axios object into your Vue single file component at the top of the <code>&lt;script&gt;</code> section. For example in TaskList.vue</p><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="highlighted-line"><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span></span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'task-list'</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><p>Now you will be able to use axios in your component's methods or computed properties to interact with the backend API server. To make an AJAX request simply invoke the appropriate HTTP request method for the API resource you want to utilize. For example, to retrieve a list of users from &quot;my-amazing-app&quot;, we use the GET method on the <code>/users</code> URI ...</p><pre class="language-js"><code>axios
  <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'https://my-amazing-app.com/api/users'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>users <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="tip custom-block"><p class="custom-block-title">Promises Promises ...</p><p>All of the axios request methods (get, post, put, delete) return a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises" target="_blank" rel="noopener noreferrer">Promise object</a>.</p></div><h3 id="response-objects"><a href="#response-objects" aria-hidden="true" class="header-anchor">#</a> Response Objects</h3><p>Axios either resolves or rejects the returned Promise based on the standard HTTP status code set by our API server. By default (although this can be customized) the Promise will be successfully resolved if the HTTP status code is in the 200 series. Otherwise it will reject the Promise.</p><div class="tip custom-block"><p class="custom-block-title">Reference</p><p><a href="http://www.restapitutorial.com/httpstatuscodes.html" target="_blank" rel="noopener noreferrer">The standard HTTP status codes</a></p><p>The most common are: 200 OK, 201 Created, 400 Bad Request, 401 Unauthorized, 403 Forbidden, 404 No Found, 422 Unprocessable, 500 Internal Server Error.</p></div><h4 id="success"><a href="#success" aria-hidden="true" class="header-anchor">#</a> Success</h4><p>Each successfully resolved Axios call returns a response object. e.g.</p><pre class="language-js"><code><span class="token punctuation">{</span>
  status<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>      <span class="token comment">// the HTTP status code from the server response</span>
  statusText<span class="token punctuation">:</span> <span class="token string">'OK'</span><span class="token punctuation">,</span> <span class="token comment">// an optional HTTP status message from the server response</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token comment">// The response payload provided by the server</span>
  headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// HTTP response headers sent from the server</span>
  request<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// the orginating XMLHttpRequest object</span>
  config<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>   <span class="token comment">// configuration parameters provided to axios for the request</span>
<span class="token punctuation">}</span>
</code></pre><p>Within the axios response <code>data</code> object, our Laravel based API server will include our target payload wrapped in another <code>data</code> object and may also include two optional objects: <code>meta</code> and <code>links</code>.</p><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

<span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  links<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  meta<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="handling-promises"><a href="#handling-promises" aria-hidden="true" class="header-anchor">#</a> Handling promises</h3><p>So, in the <code>.then()</code> promise call-back handler, we can access our target payload from the API server via the <code>response.data.data</code> property. For example ...</p><pre class="language-js"><code><span class="token function">getTasks</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  axios
    <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/tasks`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="highlighted-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>taskList <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="async-await"><a href="#async-await" aria-hidden="true" class="header-anchor">#</a> Async/Await</h4><p>But hey, its 2018. Can't we make this a little cleaner with async/await?</p><p>Sure we can! Let's have a look ...</p><pre class="language-js"><code><span class="token keyword">async</span> <span class="token function">getTasks</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/tasks`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>taskList <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
<span class="token punctuation">}</span>
</code></pre><h3 id="catching-errors"><a href="#catching-errors" aria-hidden="true" class="header-anchor">#</a> Catching errors</h3><p>OK, that's all well and good, but what happens if something goes wrong? If the HTTP status code is not in the 2xx range, axios will reject the Promise. So like any other Promise we need a <code>catch()</code> block to handle the exceptions.</p><h4 id="traditional-promises"><a href="#traditional-promises" aria-hidden="true" class="header-anchor">#</a> Traditional Promises</h4><pre class="language-js"><code><span class="token function">getTasks</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  axios
    <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/tasks`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>taskList <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="try-catch"><a href="#try-catch" aria-hidden="true" class="header-anchor">#</a> Try/Catch</h4><pre class="language-js"><code><span class="token keyword">async</span> <span class="token function">getTasks</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/tasks`</span></span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>taskList <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="something-more-robust"><a href="#something-more-robust" aria-hidden="true" class="header-anchor">#</a> Something more robust</h4><p>Of course the examples above are overly trivial. From the axios documentation we can see a better suggestion of how to handle different kinds of exceptions.</p><pre class="language-js"><code><span class="token comment">//...</span>
<span class="token punctuation">.</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The request was made and the server responded with a status code</span>
    <span class="token comment">// that falls out of the range of 2xx</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The request was made but no response was received</span>
    <span class="token comment">// `error.request` is an instance of XMLHttpRequest in the browser </span>
    <span class="token comment">// and an instance of http.ClientRequest in node.js</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Something happened in setting up the request that triggered an Error</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>For example when posting a new object to an API resource URI, we can use the <code>error.response.status</code> to know if there was a validation error (code 422) and look at the error.response.data to display appropriate messages to the user. You will remember from our <em>Build an API with Laravel</em> tutorial, we are passing back an <code>errors</code> array where each element is an object with <code>field</code> and <code>message</code> properties. So, our <code>error.response.data</code> object will look something like this ...</p><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;errors&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;field&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;The username field is required.&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;field&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;The password field is required.&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><p>And, if the <code>error.response.status</code> is 401, we know that the user must login before accessing that resource, and we should redirect them.</p><p>We might setup our <code>.catch()</code> function to handle these conditions like this ...</p><pre class="language-js"><code><span class="token comment">//...</span>
<span class="token punctuation">.</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token number">401</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">case</span> <span class="token number">422</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>errors <span class="token operator">=</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>errors
        <span class="token keyword">break</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> 
  <span class="token comment">// handle other conditions ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><h2 id="working-examples"><a href="#working-examples" aria-hidden="true" class="header-anchor">#</a> Working Examples</h2><h3 id="load-a-collection-of-resource-objects"><a href="#load-a-collection-of-resource-objects" aria-hidden="true" class="header-anchor">#</a> Load a collection of resource objects</h3><p>We can load the available task priorities from the backend server and use it to populate our &quot;filter by priority&quot; drop-down element. Lets use Vue's <code>created ()</code> event hook method to fetch the data for our <code>&lt;select&gt;</code> options.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Remember the <em>created</em> lifecycle event fires when the component is instantiated but before it is mounted to the DOM. This means that all of the component's data properties and methods are ready, but the user cannot see or interact with it yet.</p></div><pre class="language-js"><code>  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> baseURL <span class="token operator">=</span> <span class="token string">'https://vue-todos.robertmckenney.ca/api'</span>
    axios
      <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>baseURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/priorities`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>priorityOptions <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length
          <span class="token operator">?</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
          <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre><p>In the example above, we defined a local varible <code>baseURL</code> to more clearly differentiate the resource URI, i.e. <code>/proiorities</code>. As you build out this section of the project, you will need to reuse that in several other methods. So, let's move that to a more easily accessible location, like ...</p><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'task-list'</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
<span class="highlighted-line">      baseURL<span class="token punctuation">:</span> <span class="token string">'https://vue-todos.robertmckenney.ca/api'</span><span class="token punctuation">,</span></span>      <span class="token comment">// other data properties ...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// other component options ...</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    axios
<span class="highlighted-line">      <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/priorities`</span></span><span class="token punctuation">)</span></span>      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>priorityOptions <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length 
          <span class="token operator">?</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
          <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>We are using the conditional (ternary) operator to assign the response payload to our <code>priorityOptions</code> data property to ensure there is at least an empty array assigned in the event that we did not get an array back from the server.</p></div><h3 id="load-a-single-resource-object"><a href="#load-a-single-resource-object" aria-hidden="true" class="header-anchor">#</a> Load a single resource object</h3><p>To retrieve a single specific resource object, the pattern is almost the same as the collection resource. We simply add the unique ID to the resource URI. e.g. <code>/tasks/42</code></p><p>A <code>getTask()</code> method might look like this ...</p><pre class="language-js"><code><span class="token keyword">async</span> <span class="token function">getTask</span> <span class="token punctuation">(</span>taskId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/tasks/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>taskId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
<span class="token punctuation">}</span>
</code></pre><h3 id="save-a-new-resource-object"><a href="#save-a-new-resource-object" aria-hidden="true" class="header-anchor">#</a> Save a new resource object</h3><p>When the user creates a new object, we need to persist that to our backend database. Following the REST API pattern we will use the POST method on the appropriate resource URI and pass the new object as JSON data in the request body.</p><p>Axios makes this really easy for us. We simply pass the new object as the second parameter after the URI and axios will do the rest. e.g. we would have an event listener on the submit button of our AddTask.vue component ...</p><pre class="language-html"><code><span class="token comment">&lt;!-- other form elements ... --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>newTask.title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>date<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>newTask.dueAt<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="highlighted-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>saveTask(newTask)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>SAVE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span></span></code></pre><pre class="language-js"><code><span class="token keyword">async</span> <span class="token function">saveTask</span> <span class="token punctuation">(</span>newTask<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/tasks`</span></span><span class="token punctuation">,</span> newTask<span class="token punctuation">)</span>
  <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
<span class="token punctuation">}</span>
</code></pre><p>If the request was successful, the response data payload will contain the newly created object, but with the unique ID value set (and any other server side business logic applied). e.g.</p><pre class="language-js"><code><span class="token comment">// successfully created task</span>
<span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
  title<span class="token punctuation">:</span> <span class="token string">&quot;Ipsam consequatur perferendis id numquam occaecati.&quot;</span><span class="token punctuation">,</span>
  description<span class="token punctuation">:</span> <span class="token string">&quot;Corrupti vero ex ipsa id. Ipsa veritatis ipsam natus.&quot;</span><span class="token punctuation">,</span>
  priority<span class="token punctuation">:</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">&quot;medium&quot;</span><span class="token punctuation">,</span> order<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  category<span class="token punctuation">:</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">&quot;home&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  isComplete<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  dueAt<span class="token punctuation">:</span> <span class="token string">&quot;2018-06-16 02:25:14&quot;</span><span class="token punctuation">,</span>
  completedAt<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  createdAt<span class="token punctuation">:</span> <span class="token string">&quot;2018-04-14 13:27:20&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="update-a-resource-object"><a href="#update-a-resource-object" aria-hidden="true" class="header-anchor">#</a> Update a resource object</h3><p>When the user edits an object we formulate the update request almost exactly like the save request, but we use the PUT method instead of POST. Note that we could also use PATCH instead of PUT. Both verbs are supported by the REST API interface for update requests.</p><pre class="language-js"><code><span class="token keyword">async</span> <span class="token function">updateTask</span> <span class="token punctuation">(</span>task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/tasks/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>task<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span> task<span class="token punctuation">)</span>
  <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
<span class="token punctuation">}</span>
</code></pre><p>If our request is successfully processed, we will get back a success status code and the same object that we updated.</p><h3 id="delete-a-resource-object"><a href="#delete-a-resource-object" aria-hidden="true" class="header-anchor">#</a> Delete a resource object</h3><p>A DELETE request is formatted just like a GET request for a single resource except for the change of the HTTP verb.</p><pre class="language-js"><code><span class="token keyword">async</span> <span class="token function">deleteTask</span> <span class="token punctuation">(</span>task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/tasks/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>task<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
<span class="token punctuation">}</span>
</code></pre><p>Again, if our request is successfully processed, we will get back a success status code and the same object that we deleted.</p><h2 id="authentication-headers"><a href="#authentication-headers" aria-hidden="true" class="header-anchor">#</a> Authentication Headers</h2><p>Up until now our examples have been for a simple unrestricted public API. However, for most real world applications we would want some means of authentication to separate the activity of each user of our application. e.g. Sarah should not be able to see/update Abby's todo list.</p><p>Accordingly our backend team has implemented an <a href="https://oauth.net/2/" target="_blank" rel="noopener noreferrer">OAuth2</a> server to help manage access to the API resource routes. Refer back to the <em>Build an API with Laravel</em> tutorial to see how this was implemented using <a href="https://laravel.com/docs/5.6/passport" target="_blank" rel="noopener noreferrer">Laravel Passport</a>.</p><p>In our case, our frontend application will be consuming our own backend API, so we will use the <strong>Password Grant</strong> option of OAuth2. This lets our users authenticate with a username and password and then the server will send us back an <code>access_token</code> that we will include as a header on each subsequent resource request.</p><h3 id="login-get-a-token"><a href="#login-get-a-token" aria-hidden="true" class="header-anchor">#</a> Login / Get a Token</h3><p>OK, sounds like we are going to need a login page. Let's create a new LoginPage.vue component and just whip up a very basic login form in the <code>&lt;template&gt;</code> section.</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>form<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@submit.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>login<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Vue Todos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>errorMessage<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>errors<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ errorMessage }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>email<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Login name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>email<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>email<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>loginName<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>email<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">required</span>
      <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Password<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>current-password<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">required</span>
      <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>login<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      {{ isWorking ? 'Working ...' : 'LOGIN' }}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>This should all look pretty familiar by this point. We have a form with two input fields, a submit button and a placeholder for any validation errors. I have wrapped the input/label pairs in a <code>div.form-group</code> just to make CSS styling easier.</p><h4 id="the-interactive-bits"><a href="#the-interactive-bits" aria-hidden="true" class="header-anchor">#</a> The interactive bits</h4><ol><li><p>The <code>&lt;input&gt;</code> field's value attributes are bound to some properties with the <code>v-model</code> directive.</p></li><li><p>The <code>div.errors</code> block conditionally displays only if the <code>errorMessage</code> data property has a value.</p></li><li><p>We set event listeners on the <code>&lt;form&gt;</code> and <code>&lt;button&gt;</code> elements to call our <code>login</code> method.</p></li><li><p>Finally, we provide the user with visual feedback when they have submitted the form by conditionally changing the button label from <code>LOGIN</code> to <code>Working ...</code></p></li></ol><h4 id="define-data-props-and-methods"><a href="#define-data-props-and-methods" aria-hidden="true" class="header-anchor">#</a> Define data props and methods</h4><p>In the template section above we referenced some data props and mehtods that don't exist yet. Let's fix that ...</p><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      loginName<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      password<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      errorMessage<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      isWorking<span class="token punctuation">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">login</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
      <span class="token comment">// send credentials to the OAuth2 server</span>
      <span class="token comment">// get back an access_token</span>
      <span class="token comment">// save the token</span>
      <span class="token comment">// redirect to the main application view</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">handleError</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// we will create this later</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><p>Our login method doesn't do anything yet, but it has our desired actions mocked out in comments. So, let's tackle them one at a time ...</p><h4 id="send-credentials-to-the-oauth2-server"><a href="#send-credentials-to-the-oauth2-server" aria-hidden="true" class="header-anchor">#</a> Send credentials to the OAuth2 server</h4><p>We will use axios to send a POST request to the <code>/oauth/token</code> route on our server, which expects the payload data object to contain these standaard properties:</p><ul><li><p><code>grant_type</code> will be <code>password</code></p></li><li><p><code>client_id</code> will be the unique client id assigned to your frontend application</p></li><li><p><code>client_secret</code> is the unique verification hash for your client id
These let the server know what kind of token you are requesting and verifies that your application is authorized to request them.</p></li><li><p><code>username</code> is the login name for the user who is trying to login to your app</p></li><li><p><code>password</code> is their corresponding password</p></li><li><p><code>scope</code> let's us ask for authorization for certain tasks or roles that may be defined in your app.  We will not be using this for our demo, so will will set it to <code>*</code> -- everything by default.</p></li></ul><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'https://vue-todos.robertmckenney.ca/oauth/token'</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    grant_type<span class="token punctuation">:</span> <span class="token string">'password'</span><span class="token punctuation">,</span>
    client_id<span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
    client_secret<span class="token punctuation">:</span> <span class="token string">'TJJiU0ULORMxmpToXaTX4J4qo1cttVJ3nGSkg1xk'</span><span class="token punctuation">,</span>
    username<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loginName<span class="token punctuation">,</span>
    password<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token punctuation">,</span>
    scope<span class="token punctuation">:</span> <span class="token string">'*'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><h4 id="get-back-an-access-token"><a href="#get-back-an-access-token" aria-hidden="true" class="header-anchor">#</a> Get back an access_token</h4><p>As we have discussed, the axios call above returns a Promise. We can handle the successful response with a <code>.then()</code> method and notify the main App.vue component that we got our API access_token by emitting and event. We should then reset our form data.</p><pre class="language-js"><code><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'saveApiTokens'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>loginName <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>So far so good, but ... lets have a look at that response data payload for a second.</p><pre class="language-js"><code><span class="token punctuation">{</span>
  token_type<span class="token punctuation">:</span> <span class="token string">&quot;Bearer&quot;</span><span class="token punctuation">,</span>
  expires_in<span class="token punctuation">:</span> <span class="token number">1296000</span><span class="token punctuation">,</span>
  access_token<span class="token punctuation">:</span> <span class="token string">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1Ni ... UbctqdloCK7bKBfvKRCPbOpQ&quot;</span><span class="token punctuation">,</span>
  refresh_token<span class="token punctuation">:</span> <span class="token string">&quot;def502007aa8ed8a0961c02b174c9de1 ... a9bab1a7fc2b58b981e9571ba&quot;</span>
<span class="token punctuation">}</span>
</code></pre><p>Later on we are going to want to check if our token has expired. The server is giving us a duration value in seconds. We need to convert this to a fixed point in time so that we can later evaluate if that time has expired.</p><p>We need to modify our response payload before we store it. Manipulating dates in Javascript is often a pain in the behind, so this seems like a good time to look a very popular open source library called <a href="https://momentjs.com/" target="_blank" rel="noopener noreferrer">Moment.js</a>.</p><p>First we need use NPM to pull it into our project as a dependancy. Using your commandline tool (terminal / iTerm2 / PowerShell, etc), run this command inside your project folder.</p><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> moment --save
</code></pre><p>Then we need to import it into our LoginPage.vue component.</p><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> moment <span class="token keyword">from</span> <span class="token string">'moment'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><p>OK, now we can use Moment in our component's methods. In this case we want to add the token's validity duration to the current time somewhere in our <code>login()</code> method's response handler.</p><pre class="language-js"><code><span class="token keyword">const</span> expires_at <span class="token operator">=</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>expires_in<span class="token punctuation">)</span>
</code></pre><p>This gets us the value we are looking for but it needs to be integrated with the other properties of the response payload that we are going to store. We could handle this in several different ways, but this seems like a good time to practice using Javascript's <strong>rest</strong> ans <strong>spread</strong> operators.</p><p>We can use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment" target="_blank" rel="noopener noreferrer">oject destructuring</a> to extract the one property we want to change and leave &quot;the rest&quot; in another temporary variable using the <code>...</code> rest operator.</p><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> expires_in<span class="token punctuation">,</span> <span class="token operator">...</span>rest <span class="token punctuation">}</span> <span class="token operator">=</span> response<span class="token punctuation">.</span>data
</code></pre><p>So, now we two new local variable in our function. From our example above, <code>expires_in</code> holds the integer value <strong>1296000</strong> -- the number of seconds until our token expires. The <code>rest</code> variable holds an ojbect with the three other properties from the original <code>response.data</code> object: <strong>access_token</strong>, <strong>refresh_token</strong>, and <strong>token_type</strong>.</p><p>Now we can create a <em>new</em> Javascript object with a new property <code>expires_at</code> using the moment calculation from the earlier example, plus we will use the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax" target="_blank" rel="noopener noreferrer">Javascript spread operator</a> to extract each property from our <code>rest</code> variable and add them as properties of the new object that we are creating.</p><pre class="language-js"><code><span class="token keyword">const</span> apiTokens <span class="token operator">=</span> <span class="token punctuation">{</span>
  expires_at<span class="token punctuation">:</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>expires_in<span class="token punctuation">,</span> <span class="token string">'seconds'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>rest
<span class="token punctuation">}</span>
</code></pre><p>OK, great!  Now we have an <code>apiTokens</code> variable holding an object that looks something like this ...</p><pre class="language-js"><code><span class="token punctuation">{</span>
  token_type<span class="token punctuation">:</span> <span class="token string">&quot;Bearer&quot;</span><span class="token punctuation">,</span>
  expires_at<span class="token punctuation">:</span>  <span class="token string">'2018-04-20T19:36:01-04:00'</span><span class="token punctuation">,</span>
  access_token<span class="token punctuation">:</span> <span class="token string">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1Ni ... UbctqdloCK7bKBfvKRCPbOpQ&quot;</span><span class="token punctuation">,</span>
  refresh_token<span class="token punctuation">:</span> <span class="token string">&quot;def502007aa8ed8a0961c02b174c9de1 ... a9bab1a7fc2b58b981e9571ba&quot;</span>
<span class="token punctuation">}</span>
</code></pre><p>...and we can use that as the payload when emitting the 'saveApiTokens' event. The <code>.then()</code> block of our <code>login()</code> method should now look like this.</p><pre class="language-js"><code><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// eslint-disable-next-line</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> expires_in<span class="token punctuation">,</span> <span class="token operator">...</span>rest <span class="token punctuation">}</span> <span class="token operator">=</span> response<span class="token punctuation">.</span>data
  <span class="token keyword">const</span> apiTokens <span class="token operator">=</span> <span class="token punctuation">{</span>
    expires_at<span class="token punctuation">:</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>expires_in<span class="token punctuation">,</span> <span class="token string">'seconds'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>rest
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'saveApiTokens'</span><span class="token punctuation">,</span> apiTokens<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>loginName <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><h4 id="error-handler"><a href="#error-handler" aria-hidden="true" class="header-anchor">#</a> Error handler</h4><p>OK. That is the success handler. But what about if there was an error?</p><p>We can make use of the generic catch block that we looked at earlier, and fill in some specific cases like missing form fields or invalid credentials. To keep the flow of our <code>login()</code> method cleaner to read, let's extract the execption handler into a separate method and then call that in the <code>.catch()</code> block of our <code>login()</code> method.</p><pre class="language-js"><code><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><pre class="language-js"><code>
<span class="token function">handleError</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The request was made and the server responded with a status code</span>
    <span class="token comment">// that falls out of the range of 2xx</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token number">400</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>errorMessage <span class="token operator">=</span> <span class="token string">'Both login name and password are required.'</span>
        <span class="token keyword">break</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">case</span> <span class="token number">401</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>errorMessage <span class="token operator">=</span> <span class="token string">'Incorrect username or password'</span>
        <span class="token keyword">break</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> 
        <span class="token keyword">this</span><span class="token punctuation">.</span>errorMessage <span class="token operator">=</span> <span class="token string">'Sorry. There was an error processing your request.'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The request was made but no response was received</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>request<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Something happened in setting up the request that triggered an Error</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>config<span class="token punctuation">)</span>
<span class="token punctuation">}</span> 
</code></pre><h4 id="finally"><a href="#finally" aria-hidden="true" class="header-anchor">#</a> Finally</h4><p>Regardless of whether our axios call to get a token resulted in success or error, the asyncronous action is now complete and we should update our UI so the user knows we are done. With Javascript Promises, there is a third response method <code>.finally()</code> that will always execute when all of the <code>.then()</code> or <code>.catch()</code> methods are completed.</p><p>We need to reset the <code>isWorking</code> data property.</p><pre class="language-js"><code><span class="token punctuation">.</span><span class="token keyword">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>isWorking <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><h4 id="putting-it-all-together-the-login-method-should-now-look-like-this"><a href="#putting-it-all-together-the-login-method-should-now-look-like-this" aria-hidden="true" class="header-anchor">#</a> Putting it all together, the login() method should now look like this.</h4><div class="warning custom-block"><p class="custom-block-title">Remember</p><p>You need to update these demo <code>client_id</code> and <code>client_secret</code> values with your own credentials.</p></div><pre class="language-js"><code><span class="token function">login</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>errorMessage <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>isWorking <span class="token operator">=</span> <span class="token boolean">true</span>
  axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
    <span class="token string">'https://vue-todos.robertmckenney.ca/oauth/token'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      grant_type<span class="token punctuation">:</span> <span class="token string">'password'</span><span class="token punctuation">,</span>
      client_id<span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
      client_secret<span class="token punctuation">:</span> <span class="token string">'TJJiU0ULORMxmpToXaTX4J4qo1cttVJ3nGSkg1xk'</span><span class="token punctuation">,</span>
      username<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loginName<span class="token punctuation">,</span>
      password<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token punctuation">,</span>
      scope<span class="token punctuation">:</span> <span class="token string">'*'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// eslint-disable-next-line</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> expires_in<span class="token punctuation">,</span> <span class="token operator">...</span>rest <span class="token punctuation">}</span> <span class="token operator">=</span> response<span class="token punctuation">.</span>data
    <span class="token keyword">const</span> apiTokens <span class="token operator">=</span> <span class="token punctuation">{</span>
      expires_at<span class="token punctuation">:</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>expires_in<span class="token punctuation">,</span> <span class="token string">'seconds'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token operator">...</span>rest
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'saveApiTokens'</span><span class="token punctuation">,</span> apiTokens<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>loginName <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>isWorking <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="show-hide-the-login-page"><a href="#show-hide-the-login-page" aria-hidden="true" class="header-anchor">#</a> Show / Hide the Login Page</h3><p>With our LoginPage.vue component done, we need to head back over to our main App.vue component. We need to be able to conditionally render the LoginPage component when the user is not &quot;logged in&quot;.</p><p>First we need to import the LoginPage component and register it for use in the script section.</p><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  <span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
  <span class="token keyword">import</span> moment <span class="token keyword">from</span> <span class="token string">'moment'</span>
  <span class="token keyword">import</span> AddTaskForm <span class="token keyword">from</span> <span class="token string">'@/components/AddTaskForm'</span>
<span class="highlighted-line">  <span class="token keyword">import</span> LoginPage <span class="token keyword">from</span> <span class="token string">'@/pages/LoginPage'</span></span>  
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'App'</span><span class="token punctuation">,</span>
<span class="highlighted-line">    components<span class="token punctuation">:</span> <span class="token punctuation">{</span> LoginPage<span class="token punctuation">,</span> AddTaskForm <span class="token punctuation">}</span><span class="token punctuation">,</span></span>    <span class="token comment">// rest of the configuration options ...</span>
  <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><p>OK. Now, let's update the <code>&lt;template&gt;</code> section of our App.vue component. Start by adding a  <code>v-if</code> directive to the main <code>div</code> to conditionally display based on the value of a computed property called <code>isLoggedIn</code> -- this doesn't exist yet, but we'll create it shortly.</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>isLoggedIn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><p>If you test this in the browser now, you will see a blank page. Don't worry, that is what is supposed to happen. The <code>isLoggedIn</code> data property does not exist yet, so the <code>v-if</code> condition is false.</p><p>Next, we can insert the LoginPage component imediately beneath the matching closing <code>&lt;/div&gt;</code> tag. Our LoginPage component should include the <code>v-else</code> directive and an event listener for the 'saveApiTokens' event that our axios success handler will emit.</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>login-page</span> <span class="token attr-name">v-else</span> <span class="token attr-name">@saveApiTokens</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>saveApiTokens<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><p>This will work, but we should wrap the existing markup in another <code>div</code> and move the <code>id=&quot;app&quot;</code> attribute to that new top level <code>div</code> so that any global CSS settings targeting <code>#app</code> will apply to both our main application and our login page.</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>isLoggedIn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!-- links omitted for brevity --&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Vue Todos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add-task-form</span> <span class="token attr-name">@taskAdded</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>addTask<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span>
        <span class="token attr-name">:tasks</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>taskList<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">@toggleDone</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>toggleDone<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">@removeTask</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>removeTask<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>login-page</span> <span class="token attr-name">v-else</span> <span class="token attr-name">@saveApiTokens</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>saveApiTokens<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><h3 id="save-the-token"><a href="#save-the-token" aria-hidden="true" class="header-anchor">#</a> Save the token</h3><p>So, we're listening for that <strong>saveApiTokens</strong> event. Now we need to write the method for handling that event. What does it need to do?</p><ol><li>We want to assign two of the properties to our active data variables. More on this in a minute.</li><li>We want to cache the whole event payload object to localStorage so that we can reload it the next time the user starts our app.</li><li>Last, we should refresh the <code>taskList</code> property. We don't want to show the wrong user's data.</li></ol><pre class="language-js"><code><span class="token function">saveApiTokens</span> <span class="token punctuation">(</span>apiTokens<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>api<span class="token punctuation">.</span>accessToken <span class="token operator">=</span> apiTokens<span class="token punctuation">.</span>access_token
  <span class="token keyword">this</span><span class="token punctuation">.</span>api<span class="token punctuation">.</span>expiresAt <span class="token operator">=</span> apiTokens<span class="token punctuation">.</span>expires_at
  localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'todoApiTokens'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>apiTokens<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">refreshTasks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="computed-properties"><a href="#computed-properties" aria-hidden="true" class="header-anchor">#</a> Computed Properties</h3><p>Now we are going to take advantange of some of the real magic of Vue's reactivity system. With the <code>api.accessToken</code> and <code>api.expiresAt</code> data properties being dynamically set when the user logs in, we can create some computed properties that depend on those values and will be automatically updated when those values are changed.</p><h4 id="isloggedin"><a href="#isloggedin" aria-hidden="true" class="header-anchor">#</a> isLoggedIn()</h4><p>The first, <code>isLoggedIn</code> is going to determine if we show the LoginPage or the main app. It depends on two conditions.</p><ol><li>Do we have an <code>access_token</code>?</li><li>Has the <code>expires_at</code> time passed?</li></ol><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>If no date parameter is given, the <code>.isAfter()</code> method checks if the moment object is after now().</p></div><pre class="language-js"><code>computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">isLoggedIn</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>api<span class="token punctuation">.</span>accessToken <span class="token operator">&amp;&amp;</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>api<span class="token punctuation">.</span>expiresAt<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isAfter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Cool! Now when we successfully complete a login, or we load the token information from localStorage, we can automatically check if we are good to go, or if we need to display the login page. We'll cover loading from localStorage in just a minute.</p><h3 id="axios-options-object"><a href="#axios-options-object" aria-hidden="true" class="header-anchor">#</a> Axios Options Object</h3><div class="tip custom-block"><p class="custom-block-title">The Main Event</p><p>This is where it all comes together!</p></div><p>Now we get to the heart of the matter. The whole point of logging in and getting an <code>access_token</code> is becuase we need to include it in the Authorization header of every other axios call we make to the API resource routes.</p><p>A quick check of the axios documentation tells us that we can easily add a configuration options object as an additional parameter with each axios method. We can set the headers property to include our needed Authorization header, and we can also set the baseURL property so that we don't need to use string interpolation on the resource URI like we did earlier. For example ...</p><pre class="language-js"><code>methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">refreshTasks</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> axiosOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
        baseURL<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baseURL<span class="token punctuation">,</span>
        headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">'Authorization'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>api<span class="token punctuation">.</span>accessToken<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      axios
        <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/todos'</span><span class="token punctuation">,</span> axiosOptions<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>taskList <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="axiosoptions"><a href="#axiosoptions" aria-hidden="true" class="header-anchor">#</a> axiosOptions()</h4><p>Now, if we move that axiosOptions to a computed property, we can easily include it in all of our methods where axios calls our API server.</p><pre class="language-js"><code>computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token function">axiosOptions</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      baseURL<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baseURL<span class="token punctuation">,</span>
      headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">'Authorization'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>api<span class="token punctuation">.</span>accessToken<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>And our App.vue methods can be streamlined like this.</p><pre class="language-js"><code>methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function">refreshTasks</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    axios
      <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/todos'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>axiosOptions<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>taskList <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">addTask</span> <span class="token punctuation">(</span>task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    axios
      <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/todos'</span><span class="token punctuation">,</span> task<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>axiosOptions<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>taskList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toggleDone</span> <span class="token punctuation">(</span>task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    task<span class="token punctuation">.</span>isComplete <span class="token operator">=</span> <span class="token operator">!</span>task<span class="token punctuation">.</span>isComplete
    axios
      <span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`/todos/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>task<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span> task<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>axiosOptions<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">removeTask</span> <span class="token punctuation">(</span>task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    axios
      <span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`/todos/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>task<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>axiosOptions<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> taskIndex <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>taskList<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>t <span class="token operator">=&gt;</span> t<span class="token punctuation">.</span>id <span class="token operator">===</span> task<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>taskList<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>taskIndex<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">handleError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token comment">// obviously we want to do something more robust</span>
    <span class="token comment">// including notifying the user somehow.</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="load-saved-token-on-startup"><a href="#load-saved-token-on-startup" aria-hidden="true" class="header-anchor">#</a> Load saved token on startup</h3><p>We our users close the browser and then come back later, we don't want to force them to login agian. We want them to be able to start using our app as quickly as possible. That's why we cached the <code>todoApiTokens</code> in localStorage.</p><p>Now we need a method to retrieve it, and if it has not expired, load up our <code>taskList</code> from the server.</p><pre class="language-js"><code><span class="token function">loadInitialData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> apiTokens <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'todoApiTokens'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>apiTokens<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>api<span class="token punctuation">.</span>accessToken <span class="token operator">=</span> apiTokens<span class="token punctuation">.</span>access_token
    <span class="token keyword">this</span><span class="token punctuation">.</span>api<span class="token punctuation">.</span>expiresAt <span class="token operator">=</span> apiTokens<span class="token punctuation">.</span>expires_at
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>isLoggedIn<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">refreshTasks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Lastly, we need to make sure that method gets called when our main App.vue component is successfully loaded, but before it is rendered to the DOM and visible to the user.</p><div class="tip custom-block"><p class="custom-block-title">Read the Docs</p><p>Read more details on the <a href="https://vuejs.org/v2/guide/instance.html#Instance-Lifecycle-Hooks" target="_blank" rel="noopener noreferrer">Vue Lifecycle Hooks</a></p></div><p>We will call the <code>loadInitialData()</code> method from the <code>created()</code> lifecycle event handler.</p><pre class="language-js"><code><span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadInitialData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="oh-one-more-thing"><a href="#oh-one-more-thing" aria-hidden="true" class="header-anchor">#</a> Oh, one more thing ...</h3><p>It might be nice if our user could choose to <strong>logout</strong> 😉</p><p>You know what to do. We need a button with a click event listener to call a <code>logout()</code> method.</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>logout<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>LOGOUT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>And, that <code>logout()</code> method needs to clear the conditions that our <code>isLoggedIn</code> computed property is checking:</p><ol><li>Reset our token related data properties</li><li>Remove our saved copy from localStorage</li></ol><pre class="language-js"><code><span class="token function">logout</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>api<span class="token punctuation">.</span>accessToken <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>api<span class="token punctuation">.</span>expiresAt <span class="token operator">=</span> <span class="token keyword">null</span>
  localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">'todoApiTokens'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><p>Yay!! Good work! Now, take a break and then we'll start the next tutorial.</p></div><!----><!----></div></div></div>
    <script src="/vue-todos/assets/js/0.a2d473ea.js" defer></script><script src="/vue-todos/assets/js/app.909434ad.js" defer></script>
  </body>
</html>
